
## 면접 질문 내용 정리


3. GC를 조정해서 기능 개선한 경험이 있으실까요?
2. JIT과 인터프리터를 함께 사용하는 이유를 설명해주실수 있으실까요?
3. GC를 강제로 호출하는 방법을 설명해주세요
4. 순환 참조 형태의 객체는 GC에 의해 어떻게 처리될까요?
5. 만약 가능하다면 순환 참조 형태의 객체를 어떻게 GC의 대상으로 등록할 수 있을까요?
6. 순환참조가 너무 많은 경우 발생하는 현상은 무엇일까요?
7. 순환참조가 많아 OOM이 발생한 경우 어떻게 해결할까요?
8. G1GC랑 ZGC에 대해 추가적인 설명이 필요합니다
9. 여러 스레드 사이에서 JVM을 관리하도록 GC를 어떻게 사용하는지
10. GC가 동작하지 않는 케이스에 대해 예시와 함께 설명해주세요



# GC

G1gc - Gc 가 왜 필요한가
Gc 알고리즘
Jvm gc
Gc 튜닝 목표

Gc 는 왜 필요할까요 ?
Gc가 필요한 이유는 런타임시 생성된 객체의 메모리를 관리하기 위해서 입니다
메모리 해제를 적절히 해주지 않으면 메모리 누수가 발생하고 메모리가 다 차보리게되어 사용할 수 없습니다.
Gc는 동적으로 할당된 메모리 중 필요없게된 메모리를 알아서 제거해주는 역할을 수행합니다.

여기서 동적으로 할당된 메모리는 힙
영역을 의미하고 필요없게된 메모리는 가리키는 변수가 없는 것을 의미합니다.

C 나 c++ 은 메모리를 개발자가 코드단에서 직접 설정해주어야하고 java나 python은 메모리를 gc를 통해 관리가 됩니다.
Gc를 사용할 경우 메모리를 알아서 관리해준다는 장점이 존재하지만 gc 를 수행하는 작업 또한 오버헤드가 발생하게 되며 gc가 명확하게 언제 메모리를 해제하는지 시점을 알기 어려운 단점이 존재합니다.

이러한 특성때문에 실시간성이 매우 중요한 프로그램의 경우에는 gc를 사용하는 것이 좋지않은 선택일 수 있습니다.

Gc 알고리즘
Gc는 어떻게 해제할 메모리 영역을 판단할 수 있을까요 ?
reference counting과 mark and sweep이 있습니다.

그 전에 root space에 대해 얘기해보면
Stack 변수, heap변수의 주소값을 담은 영역입니다.

다시 reference counting 으로 넘어와서 reference counting 은 heap 영역에 선언된 객체들이 각각 reference count 라는 변수를 가지고 있고 이 reference count는 몇가지의 방법으로 해당 객체에 접근할 수 있는지를 나타냅니다.

여기서 reference count 가 0이 되면 해당객체에 접근하지 못한다는 것을 의미하므로 gc의 대상이 되는 것을 의미하게 됩니다

하지만 reference counting 기법에는 순환참조문제가 발생합니다. 순환참조가 발생하게 되면 두 갹체의 reference count는 외부에서 참조하는 변수가 없도라도 서로를 참조하고 있기 때문에 1로 유지가 될 것입니다.

사용하지 않는 메모리 영역이 해제되지 못하고 메모리 누수가 발생하게 됩니다.

Mark and sweep방식은 순환참조 문제를 해결할 수 있습니다.
이는 root space 로 부터 해당 객체로 접근이 가능한지에 대한 접근 여부를 해제의 기준으로 삼고 있습니다.
루트로부터 그래프 순회를 통해 연결된 객체들을 찾아내며 이 과정이 mark입니다
그리고 연결이 끊어진 객체들을 해제하며 이 과정이 sweep입니다.

Sweep이 실행되면 메모리 공간이 파편화가 되어있는데 여기서 다시 메모리 공간을 정리해주는 과정을 compaction이라고 합니다
Compaction이 중요한 이유는 메모리로 접근할때 연속적으로 접근하게 되면 성능이 좋아지기 때문입니다.

Java 와 javascript가 이 방식으로 메모리가 관리됩니다.
하지만 이 방식에 단점이 있습니다. 이 방식을 사용하기 위해서는 의도적으로 gc를 실행시켜줘야 하고 애플리케이션과 gc 실행이 병행됩니다.

즉, 어느 순간에는 컴퓨터 리소스를 gc에게 내주어야 한다는 의미입니다.

Jvm 의 gc

Jvm은 크게 3가지 영역으로 구분되게 됩니다.
바이트코드를 읽고 클래스 정보를 메모리의 heap method 영역에 저장하는 클래스 로더
실행중인 프로그램의 정보가 올라가있는 메모리
바이트코드를 네이티브코드로 변환시켜주고 gc 를 실행하능 실행엔진이 있습니다.

주요 키워드

- Young Only Phase, Space Reclamation Phase
- Stop The World
- Remembered Set
- IHOP
- Minor, Major, Mixed GC
- Young Only Phase, Space Reclamation Phase
- Region
- Garbage First
